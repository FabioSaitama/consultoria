<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagnóstico Empresarial - Entrevista Interativa</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            border-radius: 8px;
            margin-top: 30px;
            margin-bottom: 30px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: var(--secondary-color);
            font-size: 1.1em;
        }
        
        .progress-container {
            width: 100%;
            background-color: #f1f1f1;
            border-radius: 5px;
            margin-bottom: 30px;
        }
        
        .progress-bar {
            height: 10px;
            background-color: var(--secondary-color);
            border-radius: 5px;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .form-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .form-section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-title {
            color: var(--primary-color);
            margin-top: 0;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary-color);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="number"],
        textarea,
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="tel"]:focus,
        input[type="number"]:focus,
        textarea:focus,
        select:focus {
            border-color: var(--secondary-color);
            outline: none;
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.3);
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .btn {
            display: inline-block;
            background-color: var(--secondary-color);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background-color 0.3s;
        }
        
        .btn:hover {
            background-color: #2980b9;
        }
        
        .btn-secondary {
            background-color: #95a5a6;
        }
        
        .btn-secondary:hover {
            background-color: #7f8c8d;
        }
        
        .btn-container {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .nav-dots {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }
        
        .dot {
            width: 12px;
            height: 12px;
            margin: 0 5px;
            background-color: #bbb;
            border-radius: 50%;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .dot.active {
            background-color: var(--secondary-color);
        }
        
        .required:after {
            content: " *";
            color: var(--accent-color);
        }
        
        .summary-section {
            display: none;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 5px;
            margin-top: 30px;
        }
        
        .summary-section h3 {
            color: var(--primary-color);
            margin-top: 0;
        }
        
        .summary-item {
            margin-bottom: 15px;
        }
        
        .summary-item strong {
            display: block;
            margin-bottom: 5px;
            color: var(--dark-color);
        }
        
        .swot-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .swot-box {
            border: 2px solid var(--primary-color);
            border-radius: 5px;
            padding: 15px;
            background-color: #f9f9f9;
        }
        
        .swot-box h4 {
            margin-top: 0;
            text-align: center;
            color: var(--primary-color);
        }
        
        .strengths { border-color: #27ae60; }
        .weaknesses { border-color: #e74c3c; }
        .opportunities { border-color: #3498db; }
        .threats { border-color: #f39c12; }
        
        .strengths h4 { color: #27ae60; }
        .weaknesses h4 { color: #e74c3c; }
        .opportunities h4 { color: #3498db; }
        .threats h4 { color: #f39c12; }
        
        .insights-section {
            margin-top: 30px;
            padding: 20px;
            background-color: #e8f4fc;
            border-radius: 5px;
            border-left: 5px solid var(--secondary-color);
        }
        
        .insights-section h3 {
            margin-top: 0;
            color: var(--primary-color);
        }
        
        .address-group {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 15px;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                padding: 15px;
            }
            
            .btn {
                padding: 10px 15px;
                font-size: 14px;
            }
            
            .swot-grid {
                grid-template-columns: 1fr;
            }
            
            .address-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Diagnóstico Empresarial Completo</h1>
            <p class="subtitle">Preencha o formulário para gerar um relatório completo com análise SWOT e insights estratégicos</p>
        </header>
        
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        
        <form id="businessForm">
            <!-- Seção 1: Informações Cadastrais Completas -->
            <div class="form-section active" id="section1">
                <h2 class="section-title">Informações Cadastrais Completas</h2>
                
                <div class="form-group">
                    <label for="companyName" class="required">Nome da Empresa (Razão Social)</label>
                    <input type="text" id="companyName" name="companyName" required>
                </div>
                
                <div class="form-group">
                    <label for="tradeName" class="required">Nome Fantasia</label>
                    <input type="text" id="tradeName" name="tradeName" required>
                </div>
                
                <div class="form-group">
                    <label for="cnpj" class="required">CNPJ</label>
                    <input type="text" id="cnpj" name="cnpj" placeholder="00.000.000/0000-00" required>
                </div>
                
                <div class="form-group">
                    <label for="taxRegime" class="required">Regime Tributário</label>
                    <select id="taxRegime" name="taxRegime" required>
                        <option value="">Selecione...</option>
                        <option value="Simples Nacional">Simples Nacional</option>
                        <option value="Lucro Presumido">Lucro Presumido</option>
                        <option value="Lucro Real">Lucro Real</option>
                        <option value="MEI">Microempreendedor Individual (MEI)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="contactName" class="required">Nome do Responsável</label>
                    <input type="text" id="contactName" name="contactName" required>
                </div>
                
                <div class="form-group">
                    <label for="contactPosition" class="required">Cargo/Função</label>
                    <input type="text" id="contactPosition" name="contactPosition" required>
                </div>
                
                <div class="form-group">
                    <label for="phone" class="required">Telefone Celular</label>
                    <input type="tel" id="phone" name="phone" placeholder="(00) 00000-0000" required>
                </div>
                
                <div class="form-group">
                    <label for="landline">Telefone Fixo</label>
                    <input type="tel" id="landline" name="landline" placeholder="(00) 0000-0000">
                </div>
                
                <div class="form-group">
                    <label for="email" class="required">E-mail Corporativo</label>
                    <input type="email" id="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label for="address" class="required">Endereço Completo</label>
                    <div class="address-group">
                        <input type="text" id="street" name="street" placeholder="Logradouro" required>
                        <input type="text" id="number" name="number" placeholder="Número" required>
                        <input type="text" id="complement" name="complement" placeholder="Complemento">
                    </div>
                    <div class="address-group" style="margin-top: 15px;">
                        <input type="text" id="district" name="district" placeholder="Bairro" required>
                        <input type="text" id="city" name="city" placeholder="Cidade" required>
                        <input type="text" id="state" name="state" placeholder="UF" maxlength="2" required>
                    </div>
                    <input type="text" id="zipCode" name="zipCode" placeholder="CEP" style="margin-top: 15px;" required>
                </div>
                
                <div class="btn-container">
                    <button type="button" class="btn" onclick="nextSection()">Próxima Seção</button>
                </div>
            </div>
            
            <!-- Seção 2: Missão, Visão e Valores -->
            <div class="form-section" id="section2">
                <h2 class="section-title">Missão, Visão e Valores</h2>
                
                <div class="form-group">
                    <label for="mission">Qual é a missão da empresa?</label>
                    <textarea id="mission" name="mission" placeholder="Exemplo: 'Proporcionar soluções inovadoras em tecnologia que melhorem a vida das pessoas...'"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="vision">Qual é a visão da empresa?</label>
                    <textarea id="vision" name="vision" placeholder="Exemplo: 'Ser reconhecida como líder em nosso segmento até 2030...'"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="values">Quais são os valores da empresa?</label>
                    <textarea id="values" name="values" placeholder="Exemplo: 'Integridade, Inovação, Qualidade, Respeito ao Cliente...'"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="marketProblem">Qual problema de mercado sua empresa resolve?</label>
                    <textarea id="marketProblem" name="marketProblem"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="competitors">Quem são seus principais concorrentes?</label>
                    <textarea id="competitors" name="competitors"></textarea>
                </div>
                
                <div class="btn-container">
                    <button type="button" class="btn btn-secondary" onclick="prevSection()">Voltar</button>
                    <button type="button" class="btn" onclick="nextSection()">Próxima Seção</button>
                </div>
            </div>
            
            <!-- Seção 3: Modelo de Negócios -->
            <div class="form-section" id="section3">
                <h2 class="section-title">Modelo de Negócios</h2>
                
                <div class="form-group">
                    <label for="revenueModel">Qual é o modelo de receita da empresa?</label>
                    <textarea id="revenueModel" name="revenueModel" placeholder="Exemplo: 'Venda direta de produtos, assinaturas mensais, licenciamento de software...'"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="strategicObjectives">Quais são os objetivos estratégicos para os próximos 12 meses?</label>
                    <textarea id="strategicObjectives" name="strategicObjectives"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="differentiation">O que diferencia sua empresa da concorrência?</label>
                    <textarea id="differentiation" name="differentiation"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="keyResources">Quais são os recursos-chave necessários para o seu negócio?</label>
                    <textarea id="keyResources" name="keyResources" placeholder="Exemplo: 'Equipe qualificada, tecnologia proprietária, parcerias estratégicas...'"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="keyPartners">Quem são seus parceiros-chave?</label>
                    <textarea id="keyPartners" name="keyPartners" placeholder="Exemplo: 'Fornecedores exclusivos, distribuidores, parceiros tecnológicos...'"></textarea>
                </div>
                
                <div class="btn-container">
                    <button type="button" class="btn btn-secondary" onclick="prevSection()">Voltar</button>
                    <button type="button" class="btn" onclick="nextSection()">Próxima Seção</button>
                </div>
            </div>
            
            <!-- Seção 4: Estratégias de Vendas -->
            <div class="form-section" id="section4">
                <h2 class="section-title">Estratégias de Vendas e Market Share</h2>
                
                <div class="form-group">
                    <label for="salesChannels">Quais canais de venda são utilizados atualmente?</label>
                    <textarea id="salesChannels" name="salesChannels" placeholder="Exemplo: 'Loja física, e-commerce, marketplaces, venda direta...'"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="pricingStrategy">Qual é a estratégia de precificação dos produtos/serviços?</label>
                    <textarea id="pricingStrategy" name="pricingStrategy" placeholder="Exemplo: 'Preço competitivo, premium, descontos por volume...'"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="marketPosition">Como sua empresa se posiciona frente à concorrência?</label>
                    <textarea id="marketPosition" name="marketPosition" placeholder="Exemplo: 'Líder em preço, qualidade superior, atendimento personalizado...'"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="customerAcquisition">Quais ações são realizadas para conquistar novos clientes?</label>
                    <textarea id="customerAcquisition" name="customerAcquisition" placeholder="Exemplo: 'Marketing digital, indicações, participação em feiras...'"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="marketShare">Existe alguma meta de participação de mercado (market share)? Se sim, qual?</label>
                    <textarea id="marketShare" name="marketShare" placeholder="Exemplo: 'Alcançar 15% do mercado regional até o final do ano...'"></textarea>
                </div>
                
                <div class="btn-container">
                    <button type="button" class="btn btn-secondary" onclick="prevSection()">Voltar</button>
                    <button type="button" class="btn" onclick="nextSection()">Próxima Seção</button>
                </div>
            </div>
            
            <!-- Seção 5: Gestão Financeira -->
            <div class="form-section" id="section5">
                <h2 class="section-title">Gestão Financeira</h2>
                
                <div class="form-group">
                    <label for="financialPlanning">A empresa possui planejamento financeiro estruturado?</label>
                    <select id="financialPlanning" name="financialPlanning">
                        <option value="">Selecione...</option>
                        <option value="Sim, completo">Sim, completo</option>
                        <option value="Parcialmente">Parcialmente</option>
                        <option value="Não">Não</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="financialIndicators">Quais são os principais indicadores financeiros acompanhados?</label>
                    <textarea id="financialIndicators" name="financialIndicators" placeholder="Exemplo: 'Faturamento, margem de lucro, ROI, ticket médio...'"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="cashFlow">Existe controle de fluxo de caixa? Com que frequência é atualizado?</label>
                    <textarea id="cashFlow" name="cashFlow" placeholder="Exemplo: 'Sim, atualizado semanalmente com projeção para 3 meses...'"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="financialReserves">Há reservas financeiras ou fundos de emergência?</label>
                    <select id="financialReserves" name="financialReserves">
                        <option value="">Selecione...</option>
                        <option value="Sim">Sim</option>
                        <option value="Não">Não</option>
                        <option value="Em construção">Em construção</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="financialChallenges">Quais são os maiores desafios financeiros enfrentados atualmente?</label>
                    <textarea id="financialChallenges" name="financialChallenges" placeholder="Exemplo: 'Gerenciamento de custos fixos, inadimplência, sazonalidade...'"></textarea>
                </div>
                
                <div class="btn-container">
                    <button type="button" class="btn btn-secondary" onclick="prevSection()">Voltar</button>
                    <button type="button" class="btn" onclick="nextSection()">Próxima Seção</button>
                </div>
            </div>
            
            <!-- Seção 6: Análise SWOT -->
            <div class="form-section" id="section6">
                <h2 class="section-title">Análise SWOT</h2>
                <p>Preencha os campos abaixo para identificarmos os pontos fortes, fracos, oportunidades e ameaças do seu negócio.</p>
                
                <div class="swot-grid">
                    <div class="swot-box strengths">
                        <h4>Forças (Strengths)</h4>
                        <label for="strengths1">1. Quais são os principais pontos fortes da sua empresa?</label>
                        <textarea id="strengths1" name="strengths1" placeholder="Exemplo: 'Equipe altamente qualificada, marca reconhecida...'"></textarea>
                        
                        <label for="strengths2">2. Quais vantagens competitivas você possui?</label>
                        <textarea id="strengths2" name="strengths2"></textarea>
                        
                        <label for="strengths3">3. Quais recursos exclusivos sua empresa tem?</label>
                        <textarea id="strengths3" name="strengths3"></textarea>
                    </div>
                    
                    <div class="swot-box weaknesses">
                        <h4>Fraquezas (Weaknesses)</h4>
                        <label for="weaknesses1">1. Quais são as principais limitações da sua empresa?</label>
                        <textarea id="weaknesses1" name="weaknesses1" placeholder="Exemplo: 'Falta de capital para investimento, dependência de poucos clientes...'"></textarea>
                        
                        <label for="weaknesses2">2. Quais áreas precisam ser melhoradas?</label>
                        <textarea id="weaknesses2" name="weaknesses2"></textarea>
                        
                        <label for="weaknesses3">3. Quais recursos faltam para seu negócio crescer?</label>
                        <textarea id="weaknesses3" name="weaknesses3"></textarea>
                    </div>
                    
                    <div class="swot-box opportunities">
                        <h4>Oportunidades (Opportunities)</h4>
                        <label for="opportunities1">1. Quais tendências de mercado podem beneficiar seu negócio?</label>
                        <textarea id="opportunities1" name="opportunities1" placeholder="Exemplo: 'Crescimento do e-commerce, mudanças regulatórias favoráveis...'"></textarea>
                        
                        <label for="opportunities2">2. Quais necessidades não atendidas você pode explorar?</label>
                        <textarea id="opportunities2" name="opportunities2"></textarea>
                        
                        <label for="opportunities3">3. Quais parcerias poderiam trazer novos negócios?</label>
                        <textarea id="opportunities3" name="opportunities3"></textarea>
                    </div>
                    
                    <div class="swot-box threats">
                        <h4>Ameaças (Threats)</h4>
                        <label for="threats1">1. Quais são os principais riscos para seu negócio?</label>
                        <textarea id="threats1" name="threats1" placeholder="Exemplo: 'Concorrência acirrada, mudanças tecnológicas, crise econômica...'"></textarea>
                        
                        <label for="threats2">2. Quais obstáculos externos podem afetar sua empresa?</label>
                        <textarea id="threats2" name="threats2"></textarea>
                        
                        <label for="threats3">3. Quais mudanças no mercado preocupam você?</label>
                        <textarea id="threats3" name="threats3"></textarea>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="swotAnalysis">Com base nas respostas acima, como você avalia o posicionamento estratégico da sua empresa?</label>
                    <textarea id="swotAnalysis" name="swotAnalysis" placeholder="Faça uma breve análise cruzando os pontos identificados..."></textarea>
                </div>
                
                <div class="btn-container">
                    <button type="button" class="btn btn-secondary" onclick="prevSection()">Voltar</button>
                    <button type="button" class="btn" onclick="nextSection()">Próxima Seção</button>
                </div>
            </div>
            
            <!-- Seção 7: Processo Produtivo -->
            <div class="form-section" id="section7">
                <h2 class="section-title">Processo Produtivo</h2>
                
                <div class="form-group">
                    <label for="productionProcess">Quais são as etapas principais do processo produtivo?</label>
                    <textarea id="productionProcess" name="productionProcess"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="processDocumentation">Existe documentação ou mapeamento dos processos?</label>
                    <select id="processDocumentation" name="processDocumentation">
                        <option value="">Selecione...</option>
                        <option value="Sim, completo">Sim, completo</option>
                        <option value="Parcial">Parcial</option>
                        <option value="Não">Não</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="automation">Há uso de tecnologia ou automação na produção?</label>
                    <textarea id="automation" name="automation"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="bottlenecks">Quais são os principais gargalos ou ineficiências?</label>
                    <textarea id="bottlenecks" name="bottlenecks"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="inventoryManagement">Como é feita a gestão de estoque e logística?</label>
                    <textarea id="inventoryManagement" name="inventoryManagement"></textarea>
                </div>
                
                <div class="btn-container">
                    <button type="button" class="btn btn-secondary" onclick="prevSection()">Voltar</button>
                    <button type="button" class="btn" onclick="nextSection()">Próxima Seção</button>
                </div>
            </div>
            
            <!-- Seção 8: Resumo, Insights e Finalização -->
            <div class="form-section" id="section8">
                <h2 class="section-title">Resumo, Insights e Finalização</h2>
                
                <div class="summary-section" id="summarySection">
                    <h3>Resumo das Informações</h3>
                    <!-- O conteúdo será preenchido dinamicamente pelo JavaScript -->
                </div>
                
                <div class="insights-section" id="insightsSection">
                    <h3>Insights e Sugestões Estratégicas</h3>
                    <!-- O conteúdo será preenchido dinamicamente pelo JavaScript -->
                </div>
                
                <div class="form-group">
                    <label for="finalComments">Alguma observação ou comentário adicional que gostaria de incluir?</label>
                    <textarea id="finalComments" name="finalComments"></textarea>
                </div>
                
                <div class="btn-container">
                    <button type="button" class="btn btn-secondary" onclick="prevSection()">Voltar</button>
                    <button type="button" class="btn" onclick="generatePDF()">Gerar Relatório PDF</button>
                </div>
            </div>
        </form>
        
        <div class="nav-dots" id="navDots">
            <!-- Os pontos de navegação serão adicionados dinamicamente pelo JavaScript -->
        </div>
    </div>

    <script>
        // Configuração das seções
        const totalSections = 8;
        let currentSection = 1;
        
        // Inicializa os pontos de navegação
        const navDots = document.getElementById('navDots');
        for (let i = 1; i <= totalSections; i++) {
            const dot = document.createElement('div');
            dot.className = 'dot';
            dot.dataset.section = i;
            dot.addEventListener('click', function() {
                goToSection(parseInt(this.dataset.section));
            });
            navDots.appendChild(dot);
        }
        
        // Atualiza a navegação
        function updateNavigation() {
            // Atualiza a barra de progresso
            const progress = (currentSection / totalSections) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
            
            // Atualiza os pontos de navegação
            const dots = document.querySelectorAll('.dot');
            dots.forEach(dot => {
                dot.classList.remove('active');
                if (parseInt(dot.dataset.section) === currentSection) {
                    dot.classList.add('active');
                }
            });
        }
        
        // Navega para a próxima seção
        function nextSection() {
            if (validateCurrentSection()) {
                if (currentSection < totalSections) {
                    document.getElementById(`section${currentSection}`).classList.remove('active');
                    currentSection++;
                    document.getElementById(`section${currentSection}`).classList.add('active');
                    
                    // Se chegou na última seção, mostra o resumo e insights
                    if (currentSection === totalSections) {
                        showSummary();
                        generateInsights();
                    }
                    
                    updateNavigation();
                    window.scrollTo(0, 0);
                }
            }
        }
        
        // Navega para a seção anterior
        function prevSection() {
            if (currentSection > 1) {
                document.getElementById(`section${currentSection}`).classList.remove('active');
                currentSection--;
                document.getElementById(`section${currentSection}`).classList.add('active');
                updateNavigation();
                window.scrollTo(0, 0);
            }
        }
        
        // Navega para uma seção específica
        function goToSection(sectionNumber) {
            if (sectionNumber >= 1 && sectionNumber <= totalSections) {
                document.getElementById(`section${currentSection}`).classList.remove('active');
                currentSection = sectionNumber;
                document.getElementById(`section${currentSection}`).classList.add('active');
                
                if (currentSection === totalSections) {
                    showSummary();
                    generateInsights();
                }
                
                updateNavigation();
                window.scrollTo(0, 0);
            }
        }
        
        // Valida os campos obrigatórios da seção atual
        function validateCurrentSection() {
            if (currentSection === 1) {
                const requiredFields = ['companyName', 'tradeName', 'cnpj', 'taxRegime', 'contactName', 'contactPosition', 'phone', 'email', 'street', 'number', 'district', 'city', 'state', 'zipCode'];
                let isValid = true;
                
                requiredFields.forEach(field => {
                    const element = document.getElementById(field);
                    if (!element.value.trim()) {
                        element.style.borderColor = '#e74c3c';
                        isValid = false;
                    } else {
                        element.style.borderColor = '#ddd';
                    }
                });
                
                if (!isValid) {
                    alert('Por favor, preencha todos os campos obrigatórios da seção de informações cadastrais.');
                    return false;
                }
                
                // Validação básica de CNPJ
                const cnpj = document.getElementById('cnpj').value.trim();
                if (cnpj.length < 14) {
                    alert('Por favor, insira um CNPJ válido com 14 dígitos.');
                    document.getElementById('cnpj').style.borderColor = '#e74c3c';
                    return false;
                }
            }
            return true;
        }
        
        // Mostra o resumo das informações
        function showSummary() {
            const summarySection = document.getElementById('summarySection');
            summarySection.innerHTML = '<h3>Resumo das Informações</h3>';
            
            // Coleta todos os dados do formulário
            const formData = new FormData(document.getElementById('businessForm'));
            const data = {};
            
            for (const [key, value] of formData.entries()) {
                if (value.trim() !== '') {
                    data[key] = value;
                }
            }
            
            // Adiciona os itens ao resumo
            for (const key in data) {
                // Não mostra os campos da SWOT no resumo principal (serão mostrados nos insights)
                if (!key.startsWith('strengths') && !key.startsWith('weaknesses') && 
                    !key.startsWith('opportunities') && !key.startsWith('threats') && key !== 'swotAnalysis') {
                    const div = document.createElement('div');
                    div.className = 'summary-item';
                    
                    const strong = document.createElement('strong');
                    strong.textContent = getLabelText(key) + ':';
                    div.appendChild(strong);
                    
                    const span = document.createElement('span');
                    span.textContent = data[key];
                    div.appendChild(span);
                    
                    summarySection.appendChild(div);
                }
            }
        }
        
        // Gera insights estratégicos baseados na análise SWOT
        function generateInsights() {
            const insightsSection = document.getElementById('insightsSection');
            insightsSection.innerHTML = '<h3>Insights e Sugestões Estratégicas</h3>';
            
            // Coleta os dados da SWOT
            const swotData = {
                strengths: [],
                weaknesses: [],
                opportunities: [],
                threats: []
            };
            
            // Preenche os dados da SWOT
            for (let i = 1; i <= 3; i++) {
                if (document.getElementById(`strengths${i}`).value.trim()) {
                    swotData.strengths.push(document.getElementById(`strengths${i}`).value.trim());
                }
                if (document.getElementById(`weaknesses${i}`).value.trim()) {
                    swotData.weaknesses.push(document.getElementById(`weaknesses${i}`).value.trim());
                }
                if (document.getElementById(`opportunities${i}`).value.trim()) {
                    swotData.opportunities.push(document.getElementById(`opportunities${i}`).value.trim());
                }
                if (document.getElementById(`threats${i}`).value.trim()) {
                    swotData.threats.push(document.getElementById(`threats${i}`).value.trim());
                }
            }
            
            // Gera insights com base nas combinações SWOT
            const insights = [];
            
            // SO Strategies (Strengths + Opportunities)
            if (swotData.strengths.length > 0 && swotData.opportunities.length > 0) {
                insights.push({
                    title: "Estratégias SO (Forças + Oportunidades):",
                    content: `Você pode aproveitar suas forças (${swotData.strengths.join(', ')}) para explorar as oportunidades identificadas (${swotData.opportunities.join(', ')}). Considere alocar mais recursos nessas áreas para maximizar seu potencial de crescimento.`
                });
            }
            
            // ST Strategies (Strengths + Threats)
            if (swotData.strengths.length > 0 && swotData.threats.length > 0) {
                insights.push({
                    title: "Estratégias ST (Forças + Ameaças):",
                    content: `Use suas forças (${swotData.strengths.join(', ')}) para se proteger contra as ameaças identificadas (${swotData.threats.join(', ')}). Desenvolva planos de contingência que aproveitem seus pontos fortes para mitigar riscos.`
                });
            }
            
            // WO Strategies (Weaknesses + Opportunities)
            if (swotData.weaknesses.length > 0 && swotData.opportunities.length > 0) {
                insights.push({
                    title: "Estratégias WO (Fraquezas + Oportunidades):",
                    content: `Para aproveitar as oportunidades (${swotData.opportunities.join(', ')}), você precisa superar suas fraquezas (${swotData.weaknesses.join(', ')}). Considere investir em treinamento, parcerias ou tecnologia para transformar essas fraquezas em pontos fortes.`
                });
            }
            
            // WT Strategies (Weaknesses + Threats)
            if (swotData.weaknesses.length > 0 && swotData.threats.length > 0) {
                insights.push({
                    title: "Estratégias WT (Fraquezas + Ameaças):",
                    content: `As combinações entre suas fraquezas (${swotData.weaknesses.join(', ')}) e as ameaças externas (${swotData.threats.join(', ')}) representam seus maiores riscos. Desenvolva planos defensivos e considere diversificar seus negócios para reduzir vulnerabilidades.`
                });
            }
            
            // Adiciona insights genéricos se não houver dados suficientes para análise cruzada
            if (insights.length === 0) {
                if (swotData.strengths.length > 0) {
                    insights.push({
                        title: "Seus Pontos Fortes:",
                        content: `Sua empresa possui forças importantes (${swotData.strengths.join(', ')}). Considere como você pode aproveitá-las ainda mais para crescer e se diferenciar da concorrência.`
                    });
                }
                
                if (swotData.weaknesses.length > 0) {
                    insights.push({
                        title: "Áreas para Melhoria:",
                        content: `Identificamos algumas fraquezas (${swotData.weaknesses.join(', ')}) que merecem atenção. Desenvolva um plano de ação para transformar essas fraquezas em pontos fortes ou, pelo menos, neutralizar seu impacto.`
                    });
                }
            }
            
            // Adiciona os insights ao HTML
            insights.forEach(insight => {
                const div = document.createElement('div');
                div.className = 'summary-item';
                div.style.marginBottom = '20px';
                
                const strong = document.createElement('strong');
                strong.textContent = insight.title;
                div.appendChild(strong);
                
                const p = document.createElement('p');
                p.textContent = insight.content;
                p.style.marginTop = '5px';
                div.appendChild(p);
                
                insightsSection.appendChild(div);
            });
            
            // Adiciona recomendações gerais
            if (insights.length > 0) {
                const generalDiv = document.createElement('div');
                generalDiv.className = 'summary-item';
                generalDiv.style.marginTop = '30px';
                
                const strong = document.createElement('strong');
                strong.textContent = "Recomendações Gerais:";
                generalDiv.appendChild(strong);
                
                const ul = document.createElement('ul');
                ul.style.marginTop = '5px';
                ul.style.paddingLeft = '20px';
                
                const recommendations = [
                    "Monitore regularmente o ambiente externo para identificar novas oportunidades e ameaças",
                    "Desenvolva indicadores para acompanhar a evolução de suas fraquezas",
                    "Crie um plano de ação com metas claras para capitalizar suas forças",
                    "Considere realizar essa análise SWOT trimestralmente para manter sua estratégia atualizada",
                    "Envolva diferentes departamentos na análise para obter perspectivas diversas"
                ];
                
                recommendations.forEach(rec => {
                    const li = document.createElement('li');
                    li.textContent = rec;
                    li.style.marginBottom = '5px';
                    ul.appendChild(li);
                });
                
                generalDiv.appendChild(ul);
                insightsSection.appendChild(generalDiv);
            }
        }
        
        // Obtém o texto do label para cada campo
        function getLabelText(fieldName) {
            const labels = {
                'companyName': 'Razão Social',
                'tradeName': 'Nome Fantasia',
                'cnpj': 'CNPJ',
                'taxRegime': 'Regime Tributário',
                'contactName': 'Nome do Responsável',
                'contactPosition': 'Cargo/Função',
                'phone': 'Telefone Celular',
                'landline': 'Telefone Fixo',
                'email': 'E-mail Corporativo',
                'street': 'Logradouro',
                'number': 'Número',
                'complement': 'Complemento',
                'district': 'Bairro',
                'city': 'Cidade',
                'state': 'UF',
                'zipCode': 'CEP',
                'businessSegment': 'Segmento de Atuação',
                'timeInMarket': 'Tempo de Mercado',
                'mission': 'Missão da Empresa',
                'vision': 'Visão da Empresa',
                'values': 'Valores da Empresa',
                'marketProblem': 'Problema de Mercado Resolvido',
                'competitors': 'Principais Concorrentes',
                'revenueModel': 'Modelo de Receita',
                'strategicObjectives': 'Objetivos Estratégicos (12 meses)',
                'differentiation': 'Diferenciação Competitiva',
                'keyResources': 'Recursos-Chave',
                'keyPartners': 'Parceiros-Chave',
                'salesChannels': 'Canais de Venda',
                'pricingStrategy': 'Estratégia de Precificação',
                'marketPosition': 'Posicionamento no Mercado',
                'customerAcquisition': 'Aquisição de Novos Clientes',
                'marketShare': 'Meta de Market Share',
                'financialPlanning': 'Planejamento Financeiro',
                'financialIndicators': 'Indicadores Financeiros',
                'cashFlow': 'Controle de Fluxo de Caixa',
                'financialReserves': 'Reservas Financeiras',
                'financialChallenges': 'Desafios Financeiros',
                'qualityCertifications': 'Certificações de Qualidade',
                'qualityControl': 'Controle de Qualidade',
                'customerSatisfaction': 'Satisfação do Cliente',
                'qualityProblems': 'Problemas de Qualidade',
                'qualityAudits': 'Auditorias de Qualidade',
                'productionProcess': 'Processo Produtivo',
                'processDocumentation': 'Documentação de Processos',
                'automation': 'Automação na Produção',
                'bottlenecks': 'Gargalos ou Ineficiências',
                'inventoryManagement': 'Gestão de Estoque e Logística',
                'finalComments': 'Observações Adicionais',
                'swotAnalysis': 'Análise SWOT Preliminar'
            };
            
            return labels[fieldName] || fieldName;
        }
        
        // Gera o PDF
        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Configurações do PDF
            doc.setFont('helvetica');
            doc.setFontSize(16);
            
            // Título do relatório
            const companyName = document.getElementById('companyName').value.trim() || 'Empresa';
            doc.text(`Relatório de Diagnóstico Completo: ${companyName}`, 105, 20, { align: 'center' });
            
            doc.setFontSize(12);
            doc.text('Gerado em: ' + new Date().toLocaleDateString(), 105, 30, { align: 'center' });
            
            // Linha divisória
            doc.setDrawColor(200, 200, 200);
            doc.line(20, 35, 190, 35);
            
            // Adiciona as informações ao PDF
            let yPosition = 45;
            const formData = new FormData(document.getElementById('businessForm'));
            const data = {};
            
            for (const [key, value] of formData.entries()) {
                if (value.trim() !== '') {
                    data[key] = value;
                }
            }
            
            // Organiza por seções
            const sections = {
                'Informações Cadastrais': ['companyName', 'tradeName', 'cnpj', 'taxRegime', 'contactName', 'contactPosition', 
                                         'phone', 'landline', 'email', 'street', 'number', 'complement', 'district', 'city', 'state', 'zipCode'],
                'Missão, Visão e Valores': ['mission', 'vision', 'values', 'marketProblem', 'competitors'],
                'Modelo de Negócios': ['revenueModel', 'strategicObjectives', 'differentiation', 'keyResources', 'keyPartners'],
                'Estratégias de Vendas': ['salesChannels', 'pricingStrategy', 'marketPosition', 'customerAcquisition', 'marketShare'],
                'Gestão Financeira': ['financialPlanning', 'financialIndicators', 'cashFlow', 'financialReserves', 'financialChallenges'],
                'Processo Produtivo': ['productionProcess', 'processDocumentation', 'automation', 'bottlenecks', 'inventoryManagement'],
                'Observações Finais': ['finalComments']
            };
            
            // Adiciona cada seção ao PDF
            for (const sectionTitle in sections) {
                // Verifica se há dados para esta seção
                const hasData = sections[sectionTitle].some(field => data[field]);
                
                if (hasData) {
                    // Adiciona título da seção
                    doc.setFontSize(14);
                    doc.setTextColor(44, 62, 80);
                    doc.text(sectionTitle, 20, yPosition);
                    yPosition += 10;
                    
                    // Adiciona os itens da seção
                    doc.setFontSize(11);
                    doc.setTextColor(0, 0, 0);
                    
                    for (const field of sections[sectionTitle]) {
                        if (data[field]) {
                            const label = getLabelText(field);
                            const text = `${label}: ${data[field]}`;
                            
                            // Quebra o texto em várias linhas se necessário
                            const splitText = doc.splitTextToSize(text, 170);
                            doc.text(splitText, 20, yPosition);
                            yPosition += splitText.length * 7;
                            
                            // Espaço entre itens
                            yPosition += 5;
                            
                            // Verifica se precisa de nova página
                            if (yPosition > 270) {
                                doc.addPage();
                                yPosition = 20;
                            }
                        }
                    }
                    
                    // Espaço entre seções
                    yPosition += 10;
                }
            }
            
            // Adiciona a análise SWOT ao PDF
            if (data['swotAnalysis'] || data['strengths1'] || data['weaknesses1'] || data['opportunities1'] || data['threats1']) {
                doc.addPage();
                yPosition = 20;
                
                doc.setFontSize(14);
                doc.setTextColor(44, 62, 80);
                doc.text('Análise SWOT e Insights Estratégicos', 105, yPosition, { align: 'center' });
                yPosition += 15;
                
                // Adiciona a análise SWOT do usuário
                if (data['swotAnalysis']) {
                    doc.setFontSize(12);
                    doc.text('Análise Preliminar:', 20, yPosition);
                    yPosition += 7;
                    
                    doc.setFontSize(11);
                    const analysisText = doc.splitTextToSize(data['swotAnalysis'], 170);
                    doc.text(analysisText, 20, yPosition);
                    yPosition += analysisText.length * 7 + 10;
                }
                
                // Cria a matriz SWOT
                doc.setFontSize(12);
                doc.text('Matriz SWOT:', 20, yPosition);
                yPosition += 10;
                
                // Configurações para a tabela SWOT
                const swotData = {
                    strengths: [],
                    weaknesses: [],
                    opportunities: [],
                    threats: []
                };
                
                // Preenche os dados da SWOT
                for (let i = 1; i <= 3; i++) {
                    if (data[`strengths${i}`]) swotData.strengths.push(data[`strengths${i}`]);
                    if (data[`weaknesses${i}`]) swotData.weaknesses.push(data[`weaknesses${i}`]);
                    if (data[`opportunities${i}`]) swotData.opportunities.push(data[`opportunities${i}`]);
                    if (data[`threats${i}`]) swotData.threats.push(data[`threats${i}`]);
                }
                
                // Adiciona cada categoria da SWOT
                const swotCategories = [
                    { title: 'Forças (Strengths)', data: swotData.strengths, color: [39, 174, 96] },
                    { title: 'Fraquezas (Weaknesses)', data: swotData.weaknesses, color: [231, 76, 60] },
                    { title: 'Oportunidades (Opportunities)', data: swotData.opportunities, color: [52, 152, 219] },
                    { title: 'Ameaças (Threats)', data: swotData.threats, color: [243, 156, 18] }
                ];
                
                let xPosition = 20;
                const boxWidth = 85;
                const boxHeight = 60;
                
                for (const category of swotCategories) {
                    // Desenha o quadro
                    doc.setDrawColor(...category.color);
                    doc.rect(xPosition, yPosition, boxWidth, boxHeight);
                    
                    // Adiciona o título
                    doc.setFontSize(10);
                    doc.setTextColor(...category.color);
                    doc.text(category.title, xPosition + boxWidth/2, yPosition + 8, { align: 'center' });
                    
                    // Adiciona os itens
                    doc.setFontSize(8);
                    doc.setTextColor(0, 0, 0);
                    
                    let itemY = yPosition + 15;
                    for (const item of category.data) {
                        const itemText = doc.splitTextToSize('• ' + item, boxWidth - 10);
                        doc.text(itemText, xPosition + 5, itemY);
                        itemY += itemText.length * 4 + 2;
                        
                        // Verifica se o texto está saindo do quadro
                        if (itemY > yPosition + boxHeight - 5) {
                            break; // Não adiciona mais itens se não couberem
                        }
                    }
                    
                    xPosition += boxWidth;
                    
                    // Verifica se precisa ir para a próxima linha
                    if (xPosition > 120) {
                        xPosition = 20;
                        yPosition += boxHeight + 10;
                        
                        // Verifica se precisa de nova página
                        if (yPosition > 250) {
                            doc.addPage();
                            yPosition = 20;
                            xPosition = 20;
                        }
                    }
                }
                
                yPosition += boxHeight + 15;
                
                // Adiciona insights estratégicos
                if (swotData.strengths.length > 0 || swotData.weaknesses.length > 0 || 
                    swotData.opportunities.length > 0 || swotData.threats.length > 0) {
                    
                    doc.setFontSize(12);
                    doc.setTextColor(44, 62, 80);
                    doc.text('Insights Estratégicos:', 20, yPosition);
                    yPosition += 10;
                    
                    // Gera insights com base nas combinações SWOT
                    const insights = [];
                    
                    // SO Strategies (Strengths + Opportunities)
                    if (swotData.strengths.length > 0 && swotData.opportunities.length > 0) {
                        insights.push(`Estratégias SO (Forças + Oportunidades): Aproveite suas forças (${swotData.strengths.slice(0, 2).join(', ')}) para explorar as oportunidades identificadas (${swotData.opportunities.slice(0, 2).join(', ')}).`);
                    }
                    
                    // ST Strategies (Strengths + Threats)
                    if (swotData.strengths.length > 0 && swotData.threats.length > 0) {
                        insights.push(`Estratégias ST (Forças + Ameaças): Use suas forças (${swotData.strengths.slice(0, 2).join(', ')}) para mitigar as ameaças (${swotData.threats.slice(0, 2).join(', ')}).`);
                    }
                    
                    // WO Strategies (Weaknesses + Opportunities)
                    if (swotData.weaknesses.length > 0 && swotData.opportunities.length > 0) {
                        insights.push(`Estratégias WO (Fraquezas + Oportunidades): Supere fraquezas (${swotData.weaknesses.slice(0, 2).join(', ')}) para aproveitar oportunidades (${swotData.opportunities.slice(0, 2).join(', ')}).`);
                    }
                    
                    // WT Strategies (Weaknesses + Threats)
                    if (swotData.weaknesses.length > 0 && swotData.threats.length > 0) {
                        insights.push(`Estratégias WT (Fraquezas + Ameaças): Desenvolva planos defensivos para proteger-se de ameaças (${swotData.threats.slice(0, 2).join(', ')}) que exploram suas fraquezas (${swotData.weaknesses.slice(0, 2).join(', ')}).`);
                    }
                    
                    // Adiciona os insights ao PDF
                    doc.setFontSize(10);
                    doc.setTextColor(0, 0, 0);
                    
                    for (const insight of insights) {
                        const insightText = doc.splitTextToSize(insight, 170);
                        doc.text(insightText, 20, yPosition);
                        yPosition += insightText.length * 5 + 5;
                        
                        if (yPosition > 270) {
                            doc.addPage();
                            yPosition = 20;
                        }
                    }
                    
                    // Adiciona recomendações gerais
                    if (insights.length > 0) {
                        yPosition += 10;
                        doc.setFontSize(12);
                        doc.setTextColor(44, 62, 80);
                        doc.text('Recomendações Gerais:', 20, yPosition);
                        yPosition += 10;
                        
                        const recommendations = [
                            "Monitore regularmente o ambiente externo para novas oportunidades/ameaças",
                            "Desenvolva indicadores para acompanhar a evolução de suas fraquezas",
                            "Crie um plano de ação para capitalizar suas forças",
                            "Realize análises SWOT trimestralmente para manter a estratégia atualizada",
                            "Envolva diferentes departamentos para obter perspectivas diversas"
                        ];
                        
                        doc.setFontSize(10);
                        doc.setTextColor(0, 0, 0);
                        
                        for (const rec of recommendations) {
                            doc.text('• ' + rec, 25, yPosition);
                            yPosition += 7;
                            
                            if (yPosition > 270) {
                                doc.addPage();
                                yPosition = 20;
                            }
                        }
                    }
                }
            }
            
            // Salva o PDF
            doc.save(`Diagnostico_Completo_${companyName.replace(/\s+/g, '_')}.pdf`);
        }
        
        // Inicializa a navegação
        updateNavigation();
        
        // Máscara para CNPJ
        document.getElementById('cnpj').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            
            if (value.length > 12) {
                value = value.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/, '$1.$2.$3/$4-$5');
            } else if (value.length > 8) {
                value = value.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})/, '$1.$2.$3/$4');
            } else if (value.length > 5) {
                value = value.replace(/^(\d{2})(\d{3})(\d{3})/, '$1.$2.$3');
            } else if (value.length > 2) {
                value = value.replace(/^(\d{2})(\d{3})/, '$1.$2');
            }
            
            e.target.value = value;
        });
        
        // Máscara para telefone
        document.getElementById('phone').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            
            if (value.length > 10) {
                value = value.replace(/^(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
            } else if (value.length > 6) {
                value = value.replace(/^(\d{2})(\d{4})(\d{0,4})/, '($1) $2-$3');
            } else if (value.length > 2) {
                value = value.replace(/^(\d{2})(\d{0,5})/, '($1) $2');
            } else {
                value = value.replace(/^(\d{0,2})/, '($1');
            }
            
            e.target.value = value;
        });
        
        // Máscara para telefone fixo
        document.getElementById('landline').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            
            if (value.length > 10) {
                value = value.replace(/^(\d{2})(\d{4})(\d{4})/, '($1) $2-$3');
            } else if (value.length > 6) {
                value = value.replace(/^(\d{2})(\d{4})(\d{0,4})/, '($1) $2-$3');
            } else if (value.length > 2) {
                value = value.replace(/^(\d{2})(\d{0,4})/, '($1) $2');
            } else {
                value = value.replace(/^(\d{0,2})/, '($1');
            }
            
            e.target.value = value;
        });
        
        // Máscara para CEP
        document.getElementById('zipCode').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            
            if (value.length > 5) {
                value = value.replace(/^(\d{5})(\d{3})/, '$1-$2');
            }
            
            e.target.value = value;
        });
    </script>

    <div class="signature">
        <div class="signature-name">Prof. Me. Fábio Fernandes</div>
        <div class="signature-title">Professor | Consultor Empresarial | Desenvolvimento de Negócios</div>
        <div class="signature-links">
            <a href="mailto:fabio.fernandes@exemplo.com">prof.fafer@bol.com.br</a>
            <a href="https://www.linkedin.com/in/exemplo" target="_blank">www.linkedin.com/in/fábio-fernandes-437448a1</a>
        </div>
    </div>
</body>
</html>